<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Doctor Who data</title>
<link rel="stylesheet" href="css/style.css" />
</head>
<body>
<div id="doc"></div>
<script src="js/jquery-1.8.2.min.js"></script>
<script>
$(function() {
	var dr = 'js/doctors.json';
	$.getJSON(dr, function(data) {
		var doc = '<ul class="doctors">';
		doc += '<li class="doctor"><a href="#" data-doctor="'+data[0].json+'">'+data[0].doctor+' Doctor</a></li>';
		doc += '</ul>'
		$('#doc').html(doc);
		$('body').on('click', 'a', function(e){
			e.preventDefault();
			var drJson = $(this).data('doctor');
			console.log(drJson);
			$.getJSON('js/'+drJson, function(data) {
				var doc = '<ul class="doctors">';
				$.each(data, function (i, a) {
					doc += '<li><strong>'+a.actor+'</strong>';
					doc += '<ul>';
					doc += '<li>From: '+a.first_serial+', '+a.from+'</li>';
					doc += '<li>To: '+a.last_serial+', '+a.to+'</li>';
					doc += '<li>First words: "<em>'+a.first_words+'</em>"</li>';
					doc += '<li>Last words: "<em>'+a.last_words+'</em>"</li>';
					doc += '<li>Description: '+a.description;
					doc += '<ul>';
					$.each(a.seasons.season, function (i, b) {
						doc += '<li><strong>Season: '+b.season+'</strong>';
						if(b.new == 'yes'){
							doc += ' (new season)'
						} else {
							doc += ' (classic season)'
						}
						doc += '<br />from: '+b.from+' to: '+b.to;
						doc += '<ul>';
						$.each(b.serials.serial, function (i, c) {
							doc += '<li><strong>'+c.name+'</strong>';
							doc += '<ul>';
							$.each(c.episodes.episode, function (i, d) {
								doc += '<li><b>'+d.name+'</b><br />('+d.airdate+')</li>';
							});
							doc += '</ul>';
							doc += '<strong>Companions:</strong>';
							if(c.companions.companion != null){
							doc += '<ul>';
							$.each(c.companions.companion, function (i, d) {
								doc += '<li><b>'+d.character+'</b>';
								if(d.left == 'yes') {
									doc += ' (left)'
								}
								if(d.left_behind == 'yes') {
									doc += ' (left behind)'
								}
								if(d.died == 'yes') {
									doc += ' (died)'
								}
								doc += '</li>';
							});
							doc += '</ul>';
							}
							if(c.enemies.enemy != null){
							doc += '<strong>Enemies:</strong> <ul>';
							$.each(c.enemies.enemy, function (i, d) {
								doc += '<li><b>'+d.enemy+'</b></li>';
							});
							doc += '</ul>';
							}
							doc += '</li>';
						});
						doc += '</ul>';
						doc += '</li>';
					});
					doc += '</ul>'
					doc += '<ul>'
					doc += '</ul>';
					doc += '</li>';
					doc += '</ul>';
					doc += '</li>';
					doc += '<li><strong>Companions</strong>';
					doc += '<ul>';
					$.each(a.companions.companion, function (i, a) {
						doc += '<li><b>'+a.character+'</b></li>';
					});
					doc += '</ul>';
					doc += '</li>';
				});
				doc += '</ul>'
				$('#doc').html(doc);				
			});
		});
	});
});
</script>
</body>
</html>