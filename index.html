<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Doctor Who data</title>
<link rel="stylesheet" href="css/style.css" />
</head>
<body>
<div id="container">
	<div id="doc"></div>
</div>
<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script>
$(function() {
	var dr = 'doctors.json';
	$.getJSON(dr, function(data) {
		var doc = '<ul class="doctors">';
		doc += '<li class="doctor"><a href="#" data-doctor="'+data[0].json+'">'+data[0].doctor+' Doctor</a></li>';
		doc += '<li class="doctor"><a href="#" data-doctor="'+data[1].json+'">'+data[1].doctor+' Doctor</a></li>';
		doc += '<li class="doctor"><a href="#" data-doctor="'+data[8].json+'">'+data[8].doctor+' Doctor</a></li>';
		doc += '</ul>'
		$('#doc').html(doc);
		$('body').on('click', 'a', function(e){
			e.preventDefault();
			var drJson = $(this).data('doctor');
			console.log(drJson);
			$.getJSON(drJson, function(data) {
				var doc = '<ul class="doctors">';
				$.each(data, function (i, a) {
					doc += '<li><h2>'+a.actor+'</h2>';
					doc += '<ul>';
					doc += '<li>First appearance: <b>'+a.first_serial+'</b>, '+a.from+'</li>';
					doc += '<li>Last appearance: <b>'+a.last_serial+'</b>, '+a.to+'</li>';
					doc += '<li>First words: "<em>'+a.first_words+'</em>"</li>';
					doc += '<li>Last words: "<em>'+a.last_words+'</em>"</li>';
					doc += '<li>Sonic: '+a.sonic+'</li>';
					doc += '<li>Description: '+a.description;
					doc += '<ul>';
					$.each(a.seasons.season, function (i, b) {
						doc += '<li><h3>Season: '+b.season+'</h3>';
						if(b.new == 'yes'){
							doc += ' (new season)'
						} else {
							doc += ' (classic season)'
						}
						doc += '<br />from: '+b.from+' to: '+b.to;
						doc += '<ul>';
						$.each(b.serials.serial, function (i, c) {
							doc += '<li><h4>'+c.name+'</h4><span>Production Code: '+c.production_code+'</span><br /><span>Serial Overview: '+c.overview+'</span>';
							doc += '<ul>';
							$.each(c.episodes.episode, function (i, d) {
								doc += '<li><h5>'+d.name+'</h5>';
								if(d.archive != '') {
									doc += ' ('+d.archive+')';
								}
								doc += '('+d.airdate+')<br /><span>'+d.overview+'</span><br /><span>Director: <b>'+d.director+'</b></span>';
								$.each(d.writers, function (i, e) {
									doc += '<br /><span>Writer: <b>'+e.name+'</b>';
								});
								doc += '</li>';
							});
							doc += '</ul>';
							doc += '<strong>Companions:</strong>';
							if(c.companions.companion != null){
							doc += '<ul>';
							$.each(c.companions.companion, function (i, d) {
								doc += '<li><b>'+d.character+'</b>';
								if(d.left == 'yes') {
									doc += ' (left)'
								}
								if(d.left_behind == 'yes') {
									doc += ' (left behind)'
								}
								if(d.died == 'yes') {
									doc += ' (died)'
								}
								doc += '</li>';
							});
							doc += '</ul>';
							}
							if(c.enemies.enemy != ' '){
							doc += '<strong>Enemies:</strong> <ul>';
							$.each(c.enemies.enemy, function (i, d) {
								doc += '<li><b>'+d.enemy+'</b>';
								doc += '<ul>';
								$.each(d.actor, function (i, a) {
									doc += '<li>'+a.name+'</li>';
								});
								doc += '</ul>';
								doc += '</li>';
							});
							doc += '</ul>';
							}
							doc += '</li>';
						});
						doc += '</ul>';
						doc += '</li>';
					});
					doc += '</ul>'
					doc += '<ul>'
					doc += '</ul>';
					doc += '</li>';
					doc += '</ul>';
					doc += '</li>';
					doc += '<li><strong>Companions</strong>';
					doc += '<ul>';
					$.each(a.companions.companion, function (i, a) {
						doc += '<li><b>'+a.character+'</b><br>'+a.actor+' ('+a.from+' - '+a.to+')</li>';
					});
					doc += '</ul>';
					doc += '</li>';
				});
				doc += '</ul>'
				$('#doc').html(doc);				
			});
		});
	});
});
</script>
</body>
</html>
